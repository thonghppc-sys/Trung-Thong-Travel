<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trung Thông Travel - Menu Tương Tác</title>
    <style>
        body {
            box-sizing: border-box;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap');
        
        /* Tailwind CSS Reset và Base Styles */
        *, ::before, ::after { box-sizing: border-box; border-width: 0; border-style: solid; border-color: #e5e7eb; }
        html { line-height: 1.5; -webkit-text-size-adjust: 100%; -moz-tab-size: 4; tab-size: 4; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; }
        body { margin: 0; line-height: inherit; }
        
        /* Utility Classes */
        .bg-gradient-to-br { background-image: linear-gradient(to bottom right, var(--tw-gradient-stops)); }
        .from-blue-50 { --tw-gradient-from: #eff6ff; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(239, 246, 255, 0)); }
        .to-indigo-50 { --tw-gradient-to: #eef2ff; }
        .min-h-full { min-height: 100%; }
        .bg-gradient-to-r { background-image: linear-gradient(to right, var(--tw-gradient-stops)); }
        .from-slate-800 { --tw-gradient-from: #1e293b; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(30, 41, 59, 0)); }
        .to-slate-700 { --tw-gradient-to: #334155; }
        .text-white { color: rgb(255 255 255); }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .max-w-6xl { max-width: 72rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .text-center { text-align: center; }
        .text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
        .md\:text-5xl { font-size: 3rem; line-height: 1; }
        .font-bold { font-weight: 700; }
        .mb-2 { margin-bottom: 0.5rem; }
        .text-slate-300 { color: rgb(203 213 225); }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .font-light { font-weight: 300; }
        .grid { display: grid; }
        .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .gap-8 { gap: 2rem; }
        .lg\:col-span-2 { grid-column: span 2 / span 2; }
        .space-y-8 > :not([hidden]) ~ :not([hidden]) { margin-top: 2rem; }
        .rounded-2xl { border-radius: 1rem; }
        .p-6 { padding: 1.5rem; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .mb-6 { margin-bottom: 1.5rem; }
        .w-12 { width: 3rem; }
        .h-12 { height: 3rem; }
        .bg-gradient-to-br { background-image: linear-gradient(to bottom right, var(--tw-gradient-stops)); }
        .from-blue-500 { --tw-gradient-from: #3b82f6; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(59, 130, 246, 0)); }
        .to-blue-600 { --tw-gradient-to: #2563eb; }
        .rounded-full { border-radius: 9999px; }
        .justify-center { justify-content: center; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .mr-4 { margin-right: 1rem; }
        .text-slate-800 { color: rgb(30 41 59); }
        .text-slate-600 { color: rgb(71 85 105); }
        .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 1rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .p-4 { padding: 1rem; }
        .justify-between { justify-content: space-between; }
        .flex-1 { flex: 1 1 0%; }
        .font-semibold { font-weight: 600; }
        .mb-1 { margin-bottom: 0.25rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .space-x-3 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .font-medium { font-weight: 500; }
        .from-green-500 { --tw-gradient-from: #22c55e; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(34, 197, 94, 0)); }
        .to-green-600 { --tw-gradient-to: #16a34a; }
        .from-purple-500 { --tw-gradient-from: #a855f7; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(168, 85, 247, 0)); }
        .to-indigo-500 { --tw-gradient-to: #6366f1; }
        .lg\:col-span-1 { grid-column: span 1 / span 1; }
        .sticky { position: sticky; }
        .top-8 { top: 2rem; }
        .bg-white { background-color: rgb(255 255 255); }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
        .overflow-hidden { overflow: hidden; }
        .from-indigo-500 { --tw-gradient-from: #6366f1; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(99, 102, 241, 0)); }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .space-y-3 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem; }
        .text-slate-500 { color: rgb(100 116 139); }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
        .opacity-90 { opacity: 0.9; }
        .mb-3 { margin-bottom: 0.75rem; }
        .space-y-2 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem; }
        .w-full { width: 100%; }
        .bg-green-500 { background-color: rgb(34 197 94); }
        .hover\:bg-green-600:hover { background-color: rgb(22 163 74); }
        .transition-colors { transition-property: color, background-color, border-color, text-decoration-color, fill, stroke; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
        .bg-red-500 { background-color: rgb(239 68 68); }
        .hover\:bg-red-600:hover { background-color: rgb(220 38 38); }
        .text-amber-700 { color: rgb(180 83 9); }
        .text-red-500 { color: rgb(239 68 68); }
        .hover\:text-red-700:hover { color: rgb(185 28 28); }
        .ml-2 { margin-left: 0.5rem; }
        .fixed { position: fixed; }
        .top-4 { top: 1rem; }
        .right-4 { right: 1rem; }
        .z-50 { z-index: 50; }
        .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
        .duration-300 { transition-duration: 300ms; }
        .left-4 { left: 1rem; }
        .z-40 { z-index: 40; }
        .bg-blue-500 { background-color: rgb(59 130 246); }
        .space-x-2 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.5rem; }
        .bg-blue-600 { background-color: rgb(37 99 235); }
        .hover\:bg-blue-700:hover { background-color: rgb(29 78 216); }
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .rounded { border-radius: 0.25rem; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .bottom-4 { bottom: 1rem; }
        .bg-gray-800 { background-color: rgb(31 41 55); }
        .max-w-sm { max-width: 24rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .hover\:bg-blue-600:hover { background-color: rgb(37 99 235); }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .bg-yellow-500 { background-color: rgb(234 179 8); }
        .hover\:bg-yellow-600:hover { background-color: rgb(202 138 4); }
        .mt-2 { margin-top: 0.5rem; }
        .bg-gray-700 { background-color: rgb(55 65 81); }
        .inset-0 { top: 0px; right: 0px; bottom: 0px; left: 0px; }
        .bg-black { background-color: rgb(0 0 0); }
        .bg-opacity-50 { background-color: rgb(0 0 0 / 0.5); }
        .max-w-md { max-width: 28rem; }
        .mb-4 { margin-bottom: 1rem; }
        .text-green-600 { color: rgb(22 163 74); }
        .bg-blue-50 { background-color: rgb(239 246 255); }
        .p-3 { padding: 0.75rem; }
        .text-blue-800 { color: rgb(30 64 175); }
        .flex-1 { flex: 1 1 0%; }
        .bg-gray-500 { background-color: rgb(107 114 128); }
        .hover\:bg-gray-600:hover { background-color: rgb(75 85 99); }
        .max-w-4xl { max-width: 56rem; }
        .max-h-96 { max-height: 24rem; }
        .text-gray-500 { color: rgb(107 114 128); }
        .hover\:text-gray-700:hover { color: rgb(55 65 81); }
        .overflow-y-auto { overflow-y: auto; }
        .max-h-64 { max-height: 16rem; }
        .border { border-width: 1px; }
        .hover\:bg-gray-50:hover { background-color: rgb(249 250 251); }
        .items-start { align-items: flex-start; }
        .text-gray-600 { color: rgb(75 85 99); }
        .pt-4 { padding-top: 1rem; }
        .border-t { border-top-width: 1px; }
        
        @media (min-width: 768px) {
            .md\:text-5xl { font-size: 3rem; line-height: 1; }
        }
        
        @media (min-width: 1024px) {
            .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
            .lg\:col-span-2 { grid-column: span 2 / span 2; }
            .lg\:col-span-1 { grid-column: span 1 / span 1; }
        }
        
        .font-display { font-family: 'Playfair Display', serif; }
        .font-body { font-family: 'Inter', sans-serif; }
        
        .category-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            transition: all 0.3s ease;
        }
        
        .category-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .menu-item {
            background: white;
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
        }
        
        .menu-item:hover {
            border-left-color: #d97706;
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        .price-tag {
            background: linear-gradient(45deg, #d97706, #f59e0b);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .add-btn {
            background: linear-gradient(45deg, #059669, #10b981);
            transition: all 0.2s ease;
        }
        
        .add-btn:hover {
            background: linear-gradient(45deg, #047857, #059669);
            transform: scale(1.05);
        }
        
        .cart-item {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 4px solid #f59e0b;
        }
        
        .total-section {
            background: linear-gradient(135deg, #1e293b, #334155);
            color: white;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-50 min-h-full font-body">
    <header class="bg-gradient-to-r from-slate-800 to-slate-700 text-white py-8 px-6">
        <div class="max-w-6xl mx-auto text-center">
            <h1 class="font-display text-4xl md:text-5xl font-bold mb-2">🚗 Trung Thông Travel</h1>
            <p class="text-slate-300 text-lg font-light">Chuyên cung cấp phương tiện di chuyển chất lượng cao</p>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-6 py-8">
        <div class="grid lg:grid-cols-3 gap-8">
            <!-- Menu Categories -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Car Seats -->
                <section class="category-card rounded-2xl p-6">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white text-2xl mr-4">🪑</div>
                        <div>
                            <h2 class="font-display text-2xl font-bold text-slate-800">Ghế Ô Tô</h2>
                            <p class="text-slate-600">An toàn và thoải mái cho mọi chuyến đi</p>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Ghế Ô Tô Cao Cấp</h3>
                                <p class="text-slate-600 text-sm">Ghế da thật, massage, điều hòa riêng</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">6.200K</span>
                                <button onclick="addToCart('Ghế Ô Tô Cao Cấp', 6200)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                        
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Ghế Ô Tô Tiêu Chuẩn</h3>
                                <p class="text-slate-600 text-sm">Ghế nỉ êm ái, tựa lưng điều chỉnh</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">5.000K</span>
                                <button onclick="addToCart('Ghế Ô Tô Tiêu Chuẩn', 5000)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                        
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Ghế Ô Tô Phổ Thông</h3>
                                <p class="text-slate-600 text-sm">Ghế cơ bản, thoải mái cho chuyến đi ngắn</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">4.000K</span>
                                <button onclick="addToCart('Ghế Ô Tô Phổ Thông', 4000)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Strollers -->
                <section class="category-card rounded-2xl p-6">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center text-white text-2xl mr-4">🛒</div>
                        <div>
                            <h2 class="font-display text-2xl font-bold text-slate-800">Xe Đẩy</h2>
                            <p class="text-slate-600">Tiện lợi cho việc vận chuyển hành lý</p>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Xe Đẩy Cao Cấp</h3>
                                <p class="text-slate-600 text-sm">4 bánh xoay 360°, khung nhôm siêu nhẹ</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">3.000K</span>
                                <button onclick="addToCart('Xe Đẩy Cao Cấp', 3000)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                        
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Xe Đẩy Tiêu Chuẩn</h3>
                                <p class="text-slate-600 text-sm">2 bánh cố định, chắc chắn và bền bỉ</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">2.500K</span>
                                <button onclick="addToCart('Xe Đẩy Tiêu Chuẩn', 2500)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                        
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Xe Đẩy Phổ Thông</h3>
                                <p class="text-slate-600 text-sm">Thiết kế đơn giản, phù hợp nhu cầu cơ bản</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">2.000K</span>
                                <button onclick="addToCart('Xe Đẩy Phổ Thông', 2000)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Bicycles -->
                <section class="category-card rounded-2xl p-6">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-indigo-500 rounded-full flex items-center justify-center text-white text-2xl mr-4">🚲</div>
                        <div>
                            <h2 class="font-display text-2xl font-bold text-slate-800">Xe Đạp</h2>
                            <p class="text-slate-600">Thân thiện môi trường và tốt cho sức khỏe</p>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Xe Đạp Thể Thao</h3>
                                <p class="text-slate-600 text-sm">21 tốc độ, khung carbon siêu nhẹ</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">2.000K</span>
                                <button onclick="addToCart('Xe Đạp Thể Thao', 2000)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                        
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Xe Đạp Địa Hình</h3>
                                <p class="text-slate-600 text-sm">Bánh răng cưa, phù hợp mọi địa hình</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">1.800K</span>
                                <button onclick="addToCart('Xe Đạp Địa Hình', 1800)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                        
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Xe Đạp Thường</h3>
                                <p class="text-slate-600 text-sm">Thiết kế cổ điển, dễ sử dụng</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">1.200K</span>
                                <button onclick="addToCart('Xe Đạp Thường', 1200)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                        
                        <div class="menu-item rounded-xl p-4 flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="font-semibold text-slate-800 mb-1">Xe Đạp Trẻ Em</h3>
                                <p class="text-slate-600 text-sm">An toàn, màu sắc bắt mắt cho bé</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="price-tag">1.000K</span>
                                <button onclick="addToCart('Xe Đạp Trẻ Em', 1000)" class="add-btn text-white px-4 py-2 rounded-lg text-sm font-medium">Chọn</button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Cart Sidebar -->
            <div class="lg:col-span-1">
                <div class="sticky top-8">
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="bg-gradient-to-r from-blue-500 to-indigo-500 text-white p-6">
                            <h3 class="font-display text-xl font-bold flex items-center">
                                🛒 Phương Tiện Đã Chọn
                            </h3>
                        </div>
                        
                        <div class="p-6">
                            <div id="cart-items" class="space-y-3 mb-6">
                                <div class="text-center text-slate-500 py-8">
                                    <div class="text-4xl mb-2">🚗</div>
                                    <p>Chưa chọn phương tiện nào</p>
                                </div>
                            </div>
                            
                            <div id="cart-total" class="total-section rounded-xl p-4 text-center" style="display: none;">
                                <div class="text-sm opacity-90 mb-1">Tổng cộng</div>
                                <div class="text-2xl font-bold mb-3" id="total-amount">0K VNĐ</div>
                                <div class="space-y-2">
                                    <button onclick="purchaseItems()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors mb-2">
                                        💳 Mua
                                    </button>
                                    <button onclick="clearCart()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                                        🗑️ Xóa Tất Cả
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let cart = [];
        let total = 0;

        // Cấu hình Google Sheets - Thay thế bằng URL Google Apps Script của bạn
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx3M9xlAX0joncGJ6V6M21lOpf84TGt2chEKa_QWJHJz6FAFCM0yypBStukCCEkB3Hc/exec';
        
        function addToCart(itemName, price) {
            cart.push({ name: itemName, price: price });
            total += price;
            updateCartDisplay();
        }

        function removeFromCart(index) {
            total -= cart[index].price;
            cart.splice(index, 1);
            updateCartDisplay();
        }

        function clearCart() {
            cart = [];
            total = 0;
            updateCartDisplay();
        }

        async function purchaseItems() {
            if (cart.length === 0) {
                showMessage('Vui lòng chọn ít nhất một phương tiện!', 'error');
                return;
            }

            // Chuẩn bị dữ liệu đơn hàng
            const orderData = {
                id: Date.now(),
                timestamp: new Date().toLocaleString('vi-VN'),
                items: cart.map(item => `${item.name} (${item.price.toLocaleString()}K VNĐ)`).join(', '),
                total: `${total.toLocaleString()}K VNĐ`,
                itemCount: cart.length,
                itemDetails: cart
            };

            // Kiểm tra môi trường chạy
            const isLocal = window.location.protocol === 'file:' || window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

            if (isLocal) {
                // Chạy local - lưu vào localStorage
                try {
                    showMessage('Đang xử lý đơn hàng (Local Mode)...', 'loading');
                    
                    // Lấy đơn hàng cũ từ localStorage
                    const existingOrders = JSON.parse(localStorage.getItem('trungThongOrders') || '[]');
                    
                    // Thêm đơn hàng mới
                    existingOrders.push(orderData);
                    
                    // Lưu lại localStorage
                    localStorage.setItem('trungThongOrders', JSON.stringify(existingOrders));
                    
                    console.log('✅ Đơn hàng đã lưu vào localStorage:', orderData);
                    showMessage('Đơn hàng đã được lưu thành công! (Local Mode)', 'success');
                    
                    // Hiển thị thông tin đơn hàng
                    setTimeout(() => {
                        showOrderSummary(orderData, existingOrders.length);
                    }, 1000);
                    
                } catch (error) {
                    console.error('Lỗi lưu localStorage:', error);
                    showMessage('Lỗi lưu đơn hàng local!', 'error');
                }
            } else {
                // Chạy online - gửi lên Google Sheets
                if (GOOGLE_SCRIPT_URL.includes('PASTE_YOUR_SCRIPT_URL_HERE')) {
                    showMessage('Chưa cấu hình Google Sheets URL!', 'error');
                    console.log('Hướng dẫn: Thay thế PASTE_YOUR_SCRIPT_URL_HERE bằng URL thực từ Google Apps Script');
                    return;
                }

                try {
                    showMessage('Đang xử lý đơn hàng...', 'loading');
                    console.log('Đang gửi dữ liệu:', orderData);

                    const formData = new FormData();
                    formData.append('data', JSON.stringify(orderData));

                    const response = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: formData
                    });

                    console.log('Response status:', response.status);
                    showMessage('Đơn hàng đã được gửi thành công!', 'success');
                    
                } catch (error) {
                    console.error('Lỗi khi gửi dữ liệu:', error);
                    showMessage('Có lỗi xảy ra. Kiểm tra console để biết chi tiết!', 'error');
                }
            }

            // Xóa giỏ hàng sau khi xử lý
            setTimeout(() => {
                clearCart();
            }, 2000);
        }

        function showMessage(message, type) {
            // Tạo thông báo toast
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white font-medium z-50 transition-all duration-300 ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 
                'bg-blue-500'
            }`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            // Tự động xóa sau 3 giây
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        function updateCartDisplay() {
            const cartItems = document.getElementById('cart-items');
            const cartTotal = document.getElementById('cart-total');
            const totalAmount = document.getElementById('total-amount');

            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="text-center text-slate-500 py-8">
                        <div class="text-4xl mb-2">🚗</div>
                        <p>Chưa chọn phương tiện nào</p>
                    </div>
                `;
                cartTotal.style.display = 'none';
            } else {
                cartItems.innerHTML = cart.map((item, index) => `
                    <div class="cart-item rounded-lg p-3 flex justify-between items-center">
                        <div class="flex-1">
                            <div class="font-medium text-slate-800 text-sm">${item.name}</div>
                            <div class="text-amber-700 font-semibold">${item.price.toLocaleString()}K VNĐ</div>
                        </div>
                        <button onclick="removeFromCart(${index})" class="text-red-500 hover:text-red-700 ml-2">
                            ✕
                        </button>
                    </div>
                `).join('');
                
                cartTotal.style.display = 'block';
                totalAmount.textContent = `${total.toLocaleString()}K VNĐ`;
            }
        }

        // Hiển thị tóm tắt đơn hàng (cho local mode)
        function showOrderSummary(orderData, orderCount) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-6 max-w-md w-full">
                    <div class="text-center mb-4">
                        <div class="text-4xl mb-2">✅</div>
                        <h3 class="text-xl font-bold text-slate-800">Đơn Hàng Thành Công!</h3>
                    </div>
                    
                    <div class="space-y-3 mb-6">
                        <div class="flex justify-between">
                            <span class="text-slate-600">Mã đơn:</span>
                            <span class="font-medium">#${orderData.id}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">Thời gian:</span>
                            <span class="font-medium">${orderData.timestamp}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">Số lượng:</span>
                            <span class="font-medium">${orderData.itemCount} phương tiện</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">Tổng tiền:</span>
                            <span class="font-bold text-green-600">${orderData.total}</span>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 p-3 rounded-lg mb-4">
                        <div class="text-sm text-blue-800">
                            <strong>💻 Local Mode:</strong> Đơn hàng đã được lưu trên máy tính của bạn. 
                            Đây là đơn hàng thứ <strong>${orderCount}</strong>.
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button onclick="viewAllOrders()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
                            Xem Tất Cả Đơn Hàng
                        </button>
                        <button onclick="closeModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm">
                            Đóng
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Tự động đóng sau 10 giây
            setTimeout(() => {
                if (document.body.contains(modal)) {
                    document.body.removeChild(modal);
                }
            }, 10000);
        }

        // Đóng modal
        function closeModal() {
            const modals = document.querySelectorAll('.fixed.inset-0');
            modals.forEach(modal => {
                if (document.body.contains(modal)) {
                    document.body.removeChild(modal);
                }
            });
        }

        // Xem tất cả đơn hàng đã lưu
        function viewAllOrders() {
            const orders = JSON.parse(localStorage.getItem('trungThongOrders') || '[]');
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-6 max-w-4xl w-full max-h-96 overflow-hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-slate-800">📋 Tất Cả Đơn Hàng (${orders.length})</h3>
                        <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    
                    <div class="overflow-y-auto max-h-64 space-y-3">
                        ${orders.length === 0 ? 
                            '<div class="text-center text-gray-500 py-8">Chưa có đơn hàng nào</div>' :
                            orders.reverse().map(order => `
                                <div class="border rounded-lg p-3 hover:bg-gray-50">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="font-medium">#${order.id}</div>
                                        <div class="text-sm text-gray-500">${order.timestamp}</div>
                                    </div>
                                    <div class="text-sm text-gray-600 mb-1">${order.items}</div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">${order.itemCount} phương tiện</span>
                                        <span class="font-bold text-green-600">${order.total}</span>
                                    </div>
                                </div>
                            `).join('')
                        }
                    </div>
                    
                    <div class="flex justify-between mt-4 pt-4 border-t">
                        <button onclick="exportOrders()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm">
                            📥 Xuất Excel
                        </button>
                        <button onclick="clearAllOrders()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm">
                            🗑️ Xóa Tất Cả
                        </button>
                    </div>
                </div>
            `;
            
            // Đóng modal cũ trước
            closeModal();
            document.body.appendChild(modal);
        }

        // Xuất đơn hàng ra file Excel/CSV
        function exportOrders() {
            const orders = JSON.parse(localStorage.getItem('trungThongOrders') || '[]');
            
            if (orders.length === 0) {
                showMessage('Không có đơn hàng để xuất!', 'error');
                return;
            }
            
            // Tạo CSV content
            let csvContent = 'Mã Đơn,Thời Gian,Danh Sách Phương Tiện,Tổng Tiền,Số Lượng\n';
            
            orders.forEach(order => {
                csvContent += `${order.id},"${order.timestamp}","${order.items}","${order.total}",${order.itemCount}\n`;
            });
            
            // Tạo và download file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `trung-thong-orders-${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showMessage('Đã xuất file thành công!', 'success');
        }

        // Xóa tất cả đơn hàng
        function clearAllOrders() {
            if (confirm('Bạn có chắc muốn xóa tất cả đơn hàng? Hành động này không thể hoàn tác!')) {
                localStorage.removeItem('trungThongOrders');
                showMessage('Đã xóa tất cả đơn hàng!', 'success');
                closeModal();
            }
        }

        // Load dữ liệu từ Google Sheets khi trang được tải (tùy chọn)
        async function loadMenuFromSheets() {
            try {
                // Có thể thêm chức năng load menu từ Google Sheets ở đây
                console.log('Có thể load menu từ Google Sheets');
            } catch (error) {
                console.error('Lỗi khi load dữ liệu từ Google Sheets:', error);
            }
        }

        // Gọi khi trang được tải
        document.addEventListener('DOMContentLoaded', function() {
            loadMenuFromSheets();
            
            // Kiểm tra môi trường và hiển thị thông báo
            const isLocal = window.location.protocol === 'file:' || window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            
            if (isLocal) {
                showLocalModeIndicator();
            }
            
            // Thêm debug panel nếu có ?debug=true trong URL
            if (window.location.search.includes('debug=true')) {
                createDebugPanel();
            }
        });

        // Hiển thị chỉ báo Local Mode
        function showLocalModeIndicator() {
            const indicator = document.createElement('div');
            indicator.className = 'fixed top-4 left-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-40 text-sm';
            indicator.innerHTML = `
                <div class="flex items-center space-x-2">
                    <span>💻</span>
                    <span><strong>Local Mode</strong> - Đơn hàng lưu trên máy tính</span>
                    <button onclick="viewAllOrders()" class="ml-2 bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs">
                        Xem Đơn Hàng
                    </button>
                </div>
            `;
            
            document.body.appendChild(indicator);
            
            // Tự động ẩn sau 5 giây
            setTimeout(() => {
                indicator.style.opacity = '0.7';
            }, 5000);
        }

        // Tạo debug panel với nhiều tính năng test
        function createDebugPanel() {
            const debugPanel = document.createElement('div');
            debugPanel.className = 'fixed bottom-4 right-4 bg-gray-800 text-white p-4 rounded-lg shadow-lg z-50 max-w-sm';
            debugPanel.innerHTML = `
                <div class="text-lg font-bold mb-3">🔧 Debug Panel</div>
                <div class="space-y-2">
                    <button id="test-connection" class="w-full bg-blue-500 hover:bg-blue-600 px-3 py-2 rounded text-sm">
                        Test Kết Nối
                    </button>
                    <button id="test-send-data" class="w-full bg-green-500 hover:bg-green-600 px-3 py-2 rounded text-sm">
                        Test Gửi Dữ Liệu
                    </button>
                    <button id="show-config" class="w-full bg-yellow-500 hover:bg-yellow-600 px-3 py-2 rounded text-sm">
                        Hiện Cấu Hình
                    </button>
                    <button id="clear-console" class="w-full bg-red-500 hover:bg-red-600 px-3 py-2 rounded text-sm">
                        Xóa Console
                    </button>
                    <div id="debug-status" class="text-xs mt-2 p-2 bg-gray-700 rounded">
                        Sẵn sàng debug...
                    </div>
                </div>
            `;
            
            document.body.appendChild(debugPanel);
            
            // Gắn sự kiện cho các nút debug
            document.getElementById('test-connection').onclick = testConnectionDebug;
            document.getElementById('test-send-data').onclick = testSendDataDebug;
            document.getElementById('show-config').onclick = showConfigDebug;
            document.getElementById('clear-console').onclick = () => {
                console.clear();
                updateDebugStatus('Console đã được xóa');
            };
        }

        function updateDebugStatus(message) {
            const statusEl = document.getElementById('debug-status');
            if (statusEl) {
                statusEl.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            }
        }

        async function testConnectionDebug() {
            updateDebugStatus('Đang test kết nối...');
            console.log('🔍 Bắt đầu test kết nối Google Apps Script');
            
            try {
                if (GOOGLE_SCRIPT_URL.includes('PASTE_YOUR_SCRIPT_URL_HERE')) {
                    console.error('❌ URL chưa được cấu hình!');
                    updateDebugStatus('❌ URL chưa cấu hình');
                    showMessage('Chưa cấu hình Google Apps Script URL!', 'error');
                    return;
                }
                
                console.log('📡 Đang gửi GET request tới:', GOOGLE_SCRIPT_URL);
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'GET'
                });
                
                console.log('📊 Response status:', response.status);
                console.log('📊 Response headers:', [...response.headers.entries()]);
                
                const text = await response.text();
                console.log('📄 Response text:', text);
                
                if (response.ok && text.includes('Google Apps Script')) {
                    console.log('✅ Kết nối thành công!');
                    updateDebugStatus('✅ Kết nối OK');
                    showMessage('Kết nối Google Apps Script thành công!', 'success');
                } else {
                    console.log('⚠️ Kết nối có vấn đề');
                    updateDebugStatus('⚠️ Kết nối có vấn đề');
                    showMessage('Kết nối có vấn đề, kiểm tra console', 'error');
                }
                
            } catch (error) {
                console.error('❌ Lỗi kết nối:', error);
                updateDebugStatus('❌ Lỗi kết nối');
                showMessage('Lỗi kết nối: ' + error.message, 'error');
            }
        }

        async function testSendDataDebug() {
            updateDebugStatus('Đang test gửi dữ liệu...');
            console.log('🔍 Bắt đầu test gửi dữ liệu');
            
            try {
                // Tạo dữ liệu test
                const testData = {
                    timestamp: new Date().toLocaleString('vi-VN'),
                    items: 'Test Item (1000K VNĐ)',
                    total: '1000K VNĐ',
                    itemCount: 1
                };
                
                console.log('📦 Dữ liệu test:', testData);
                
                // Thử gửi với FormData
                const formData = new FormData();
                formData.append('data', JSON.stringify(testData));
                
                console.log('📡 Đang gửi POST request...');
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });
                
                console.log('📊 POST Response status:', response.status);
                
                // Thử đọc response (có thể bị CORS block)
                try {
                    const responseText = await response.text();
                    console.log('📄 POST Response:', responseText);
                } catch (corsError) {
                    console.log('⚠️ Không đọc được response (CORS), nhưng request có thể đã thành công');
                }
                
                updateDebugStatus('✅ Đã gửi test data');
                showMessage('Đã gửi dữ liệu test, kiểm tra Google Sheets!', 'success');
                
            } catch (error) {
                console.error('❌ Lỗi gửi dữ liệu:', error);
                updateDebugStatus('❌ Lỗi gửi data');
                showMessage('Lỗi gửi dữ liệu: ' + error.message, 'error');
            }
        }

        function showConfigDebug() {
            console.log('🔧 Cấu hình hiện tại:');
            console.log('📍 Google Script URL:', GOOGLE_SCRIPT_URL);
            console.log('🛒 Giỏ hàng hiện tại:', cart);
            console.log('💰 Tổng tiền:', total);
            console.log('🌐 User Agent:', navigator.userAgent);
            console.log('📱 Viewport:', window.innerWidth + 'x' + window.innerHeight);
            
            updateDebugStatus('✅ Đã hiện cấu hình');
            showMessage('Cấu hình đã được in ra console!', 'success');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99369a80f394fd1a',t:'MTc2MTI3ODgwNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
